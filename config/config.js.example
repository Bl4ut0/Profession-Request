// config/config.js.example
// Copy this file to config.js and fill in your actual Discord IDs
// For detailed documentation, see: docs/FLOW_STANDARDS.md and docs/17-FLOW_MESSAGE_CLEANUP.md

module.exports = {
  // ========================================
  // DISCORD SERVER CONFIGURATION
  // ========================================
  
  // Your Discord Server ID (Guild ID)
  // Where: Right-click server icon → Copy Server ID (requires Developer Mode enabled)
  guildId: "YOUR_GUILD_ID",
  
  // Category ID where request channels will be created (channel mode only)
  // Where: Right-click category → Copy Category ID
  requestCategoryId: "YOUR_CATEGORY_ID",
  
  // The main requests channel ID (set to null to auto-create in channel mode)
  // Where: Right-click channel → Copy Channel ID
  requestChannelId: "YOUR_CHANNEL_ID",
  
  // Name for the main request channel (used when creating the channel)
  requestChannelName: "requests",

  // ========================================
  // INTERACTION MODE CONFIGURATION
  // ========================================
  
  // How requests are delivered to users
  // Options: "dm" (Direct Messages) or "channel" (Temporary Channels)
  // See: docs/02-FLOW_ARCHITECTURE.md for mode comparison
  requestMode: "dm",
  
  // Show navigation messages when users trigger flows from guild channels
  // When true: Shows "I've sent you a DM" or "Continue in <#channel>" messages
  // When false: Silently handles interaction (cleaner UX)
  showNavigationMessages: false,

  // ========================================
  // MESSAGE CLEANUP CONFIGURATION
  // See: docs/17-FLOW_MESSAGE_CLEANUP.md
  // ========================================
  
  // Cleanup timeouts for different message types (in milliseconds)
  // These control automatic cleanup timing for inactive flows
  cleanupTimeouts: {
    // PRIMARY MENU: Main DM welcome menu with 4 buttons
    // Buttons: Create Request | Manage Requests | My Requests | Manage Characters
    primaryMenu: 300000,  // 5 minutes (300000ms)
    
    // SUBMENU: All other menus, including Manage Requests crafter/admin menus
    submenu: 90000,       // 90 seconds (90000ms)
    
    // COMPLETION: Final confirmation messages after state changes
    completion: 30000     // 30 seconds (30000ms)
  },
  
  // Cleanup old messages/channels on bot startup
  // DM mode: Cleans all bot messages from DMs (except main menu)
  // Channel mode: Deletes all temporary request channels
  cleanupOnStartup: true,

  // ========================================
  // DISCORD API CONFIGURATION
  // ========================================
  
  // Message fetching configuration
  messageFetchLimit: 100,           // How many messages to fetch when searching/cleaning
  messageFetchDelay: 100,           // Delay (ms) after cleanup before fetching messages
  
  // Message deletion rate limiting (prevents Discord API rate limits)
  messageDeleteDelay: 50,           // Delay (ms) between individual message deletes in DMs
  
  // Startup cleanup delays (prevents race conditions)
  startupDMCleanupDelay: 100,       // Delay (ms) between DM cleanup operations
  startupChannelCleanupDelay: 500,  // Delay (ms) between channel deletion operations
  
  // User feedback delays (how long to show confirmation messages)
  confirmationMessageDelay: 3000,   // Delay (ms) for "Request claimed/completed/released" messages
  characterConfirmationDelay: 2000, // Delay (ms) for "Character added/removed" messages
  
  // Message search limits (for finding specific recent messages)
  recentMessageSearchLimit: 10,     // How many recent messages to search when looking for flow context

  // ========================================
  // ROLE & PERMISSION CONFIGURATION
  // ========================================
  
  // Role IDs for permission checks
  // IMPORTANT: Must be strings to avoid JavaScript number precision issues
  // Where: Server Settings → Roles → Right-click role → Copy Role ID
  // Set to null to disable role-based permission checks
  
  roles: {
    // HIERARCHICAL PERMISSION SYSTEM
    // Officers inherit permissions from profession and register roles automatically
    // Hierarchy: admin > professions > register
    
    // Admin/Officer Role (HIGHEST PERMISSION)
    // - Full admin access to all request management
    // - Automatically inherits profession permissions (can claim/complete any profession)
    // - Automatically inherits register permissions (can create characters/requests)
    admin: "YOUR_ADMIN_ROLE_ID",
    
    // Profession Roles (MIDDLE PERMISSION)
    // - Can claim/complete requests for their profession
    // - Automatically inherits register permissions (can create characters/requests)
    // - Must match profession names in enabledProfessions array
    professions: {
      enchanting: "YOUR_ENCHANTER_ROLE_ID",
      tailoring: "YOUR_TAILOR_ROLE_ID",
      // Add more professions as needed
    },
    
    // Register Role (BASE PERMISSION)
    // - Required to use /register command and create requests
    // - Base level access
    register: "YOUR_REGISTER_ROLE_ID",
    
    // Core Role (SPECIAL PERMISSION)
    // - Required to request guild-provided materials (Guild Craft option)
    // - Allows "Guild Craft" button where guild provides all materials
    // - Set to null to disable this feature (all users must provide materials)
    // - Admins automatically have Core permission
    core: null  // "YOUR_CORE_ROLE_ID" or null to disable
  },
  
  // Legacy role accessors (for backward compatibility)
  // You can still use these in your code, but the new roles structure is preferred
  get requiredRegisterRoleId() { return this.roles.register; },
  get adminRoleId() { return this.roles.admin; },
  get professionRoles() { return this.roles.professions; },
  get coreRoleId() { return this.roles.core; },

  // ========================================
  // PROFESSION CONFIGURATION
  // See: docs/PROFESSION_DATA_FORMAT.md
  // See: docs/19-MULTI_PROFESSION_SYSTEM.md
  // ========================================
  
  // Enabled professions (must have corresponding JSON files in config/)
  // Format: ["profession1", "profession2"]
  // Files: config/enchanting.json, config/tailoring.json, etc.
  enabledProfessions: ["enchanting", "tailoring"],
  
  // Gear slots available for requests
  // Must match slot names in profession JSON files (case-sensitive)
  // See: docs/PROFESSION_DATA_FORMAT.md for slot naming standards
  enabledGearSlots: [
    "Head", "Neck", "Shoulders", "Chest", "Waist",
    "Legs", "Feet", "Hands", "Back",
    "Ring", "Weapon", "2H Weapon", "Shield", "Off-Hand",
    "Bags", "Shirt"
  ],

  // ========================================
  // REQUEST DISPLAY CONFIGURATION
  // ========================================
  
  // Which request statuses are shown by default in /requests command
  // Options: "open", "claimed", "in_progress", "completed", "cancelled"
  defaultVisibleStatuses: ["open", "claimed", "in_progress"],
  
  // How many completed/cancelled requests to show in history
  // Applies to: /requests command history view
  requestHistoryLimit: 10,

  // ========================================
  // NOTIFICATION CONFIGURATION
  // ========================================
  
  // Notification settings for request status changes
  // Users receive DMs when their requests change status
  notificationSettings: {
    enabled: true,           // Master switch for all notifications
    notifyOnClaim: true,     // When a crafter claims the request
    notifyOnProgress: true,  // When status changes to "in_progress"
    notifyOnComplete: true,  // When request is marked complete
    notifyOnRelease: true,   // When crafter releases request back to open
    notifyOnCancel: true     // When admin cancels the request
  },

  // ========================================
  // DATABASE BACKUP CONFIGURATION
  // ========================================
  
  // Automatic database backup settings
  databaseBackup: {
    enabled: true,              // Master switch for automatic backups
    backupOnStartup: false,     // Create backup when bot starts
    intervalHours: 12,          // How often to create backups (in hours)
    maxBackups: 28,             // Maximum number of backups to retain (oldest deleted first)
    // Backups saved to: data/backups/guild-requests_YYYY-MM-DDTHH-MM-SS.sqlite
  },

  // ========================================
  // DEBUGGING CONFIGURATION
  // ========================================
  
  // Enable verbose console logging for development
  // When true: Logs detailed flow information, cleanup operations, database queries
  // When false: Only logs warnings and errors
  debugMode: false
};
